{"version":3,"sources":["auto-reload.js","app.js"],"names":["WebSocket","window","MozWebSocket","br","brunch","ar","disabled","cacheBuster","url","date","Math","round","Date","now","toString","replace","indexOf","browser","navigator","userAgent","toLowerCase","forceRepaint","reloaders","page","location","reload","stylesheet","slice","call","document","querySelectorAll","filter","link","val","getAttribute","href","forEach","setTimeout","body","offsetHeight","port","host","server","hostname","connect","connection","onmessage","event","message","data","reloader","onerror","readyState","close","onclose","Marvel","init","search","instantsearch","appId","apiKey","indexName","urlSync","searchFunction","helper","lazyloadCounter","on","onRender","addSearchBoxWidget","addStatsWidget","addTeamsWidget","addAuthorsWidget","addPowersWidget","addSpeciesWidget","addHitsWidget","addPaginationWidget","addRefinementList","addOpenProfile","start","cloudinary","options","baseUrl","stringOptions","width","push","height","quality","crop","format","colorize","color","gravity","join","transformItem","mainColorHexa","_","get","mainColorRgb","mainColor","red","green","blue","thumbnail","background","backgroundOptions","backgroundProfile","backgroundProfileOptions","inViewport","undefined","matchingAttributes","getMatchingAttributes","readableMatchingAttributes","isFoundInName","has","isFoundInDescription","hasAliases","hasSecretIdentities","aliases","concat","secretIdentities","readableTitles","authors","powers","teams","each","value","key","isArray","label","isMatchingInNotDisplayedAttributes","isEmpty","displayData","uuid","objectID","name","description","highlightedName","getHighlightedValue","highlightedDescription","urls","species","json","JSON","stringify","transformProfileData","facetNames","refinements","facetName","facetRefinements","getRefinements","map","refinement","facets","facetValue","isRefined","includes","hasFacets","mapValues","length","profileData","console","info","highlightedResults","_highlightResult","highlightValue","attributeName","isObject","matchLevel","compact","matchValue","omitBy","object","property","hits","$","onVisible","hit","addClass","offset","addWidget","widgets","searchBox","container","placeholder","stats","refinementList","operator","limit","sortBy","showMore","hitTemplate","html","emptyTemplate","hitsPerPage","templates","empty","item","transformData","pagination","labels","previous","next","showFirstLast","currentRefinedValues","clearAll","template","Hogan","compile","profile","closeProfile","removeClass","currentTarget","find","text","parse","render","_event","target","toggleRefinement","toggleClass"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA,CAAC,YAAW;AACV,MAAIA,YAAYC,OAAOD,SAAP,IAAoBC,OAAOC,YAA3C;AACA,MAAIC,KAAKF,OAAOG,MAAP,GAAiBH,OAAOG,MAAP,IAAiB,EAA3C;AACA,MAAIC,KAAKF,GAAG,aAAH,IAAqBA,GAAG,aAAH,KAAqB,EAAnD;AACA,MAAI,CAACH,SAAD,IAAcK,GAAGC,QAArB,EAA+B;;AAE/B,MAAIC,cAAc,SAAdA,WAAc,CAASC,GAAT,EAAa;AAC7B,QAAIC,OAAOC,KAAKC,KAAL,CAAWC,KAAKC,GAAL,KAAa,IAAxB,EAA8BC,QAA9B,EAAX;AACAN,UAAMA,IAAIO,OAAJ,CAAY,yBAAZ,EAAuC,EAAvC,CAAN;AACA,WAAOP,OAAOA,IAAIQ,OAAJ,CAAY,GAAZ,KAAoB,CAApB,GAAwB,GAAxB,GAA8B,GAArC,IAA2C,cAA3C,GAA4DP,IAAnE;AACD,GAJD;;AAMA,MAAIQ,UAAUC,UAAUC,SAAV,CAAoBC,WAApB,EAAd;AACA,MAAIC,eAAehB,GAAGgB,YAAH,IAAmBJ,QAAQD,OAAR,CAAgB,QAAhB,IAA4B,CAAC,CAAnE;;AAEA,MAAIM,YAAY;AACdC,UAAM,gBAAU;AACdtB,aAAOuB,QAAP,CAAgBC,MAAhB,CAAuB,IAAvB;AACD,KAHa;;AAKdC,gBAAY,sBAAU;AACpB,SAAGC,KAAH,CACGC,IADH,CACQC,SAASC,gBAAT,CAA0B,sBAA1B,CADR,EAEGC,MAFH,CAEU,UAASC,IAAT,EAAe;AACrB,YAAIC,MAAMD,KAAKE,YAAL,CAAkB,iBAAlB,CAAV;AACA,eAAOF,KAAKG,IAAL,IAAaF,OAAO,OAA3B;AACD,OALH,EAMGG,OANH,CAMW,UAASJ,IAAT,EAAe;AACtBA,aAAKG,IAAL,GAAY5B,YAAYyB,KAAKG,IAAjB,CAAZ;AACD,OARH;;AAUA;AACA,UAAId,YAAJ,EAAkBgB,WAAW,YAAW;AAAER,iBAASS,IAAT,CAAcC,YAAd;AAA6B,OAArD,EAAuD,EAAvD;AACnB;AAlBa,GAAhB;AAoBA,MAAIC,OAAOnC,GAAGmC,IAAH,IAAW,IAAtB;AACA,MAAIC,OAAOtC,GAAGuC,MAAH,IAAazC,OAAOuB,QAAP,CAAgBmB,QAA7B,IAAyC,WAApD;;AAEA,MAAIC,UAAU,SAAVA,OAAU,GAAU;AACtB,QAAIC,aAAa,IAAI7C,SAAJ,CAAc,UAAUyC,IAAV,GAAiB,GAAjB,GAAuBD,IAArC,CAAjB;AACAK,eAAWC,SAAX,GAAuB,UAASC,KAAT,EAAe;AACpC,UAAI1C,GAAGC,QAAP,EAAiB;AACjB,UAAI0C,UAAUD,MAAME,IAApB;AACA,UAAIC,WAAW5B,UAAU0B,OAAV,KAAsB1B,UAAUC,IAA/C;AACA2B;AACD,KALD;AAMAL,eAAWM,OAAX,GAAqB,YAAU;AAC7B,UAAIN,WAAWO,UAAf,EAA2BP,WAAWQ,KAAX;AAC5B,KAFD;AAGAR,eAAWS,OAAX,GAAqB,YAAU;AAC7BrD,aAAOoC,UAAP,CAAkBO,OAAlB,EAA2B,IAA3B;AACD,KAFD;AAGD,GAdD;AAeAA;AACD,CAtDD;AAuDA;;;;;;;;;;ACxDA,IAAIW,SAAS;AACXC,MADW,kBACJ;AACL,SAAKC,MAAL,GAAcC,cAAc;AAC1BC,aAAO,YADmB;AAE1BC,cAAQ,kCAFkB;AAG1BC,iBAAW,QAHe;AAI1BC,eAAS,IAJiB;AAK1BC,sBAAgB,wBAACC,MAAD,EAAY;AAC1B;AACAT,eAAOU,eAAP,GAAyB,CAAzB;AACAD,eAAOP,MAAP;AACD;AATyB,KAAd,CAAd;;AAYA,SAAKA,MAAL,CAAYS,EAAZ,CAAe,QAAf,EAAyB,KAAKC,QAA9B;;AAEA,SAAKC,kBAAL;AACA,SAAKC,cAAL;AACA,SAAKC,cAAL;AACA,SAAKC,gBAAL;AACA,SAAKC,eAAL;AACA,SAAKC,gBAAL;AACA,SAAKC,aAAL;AACA,SAAKC,mBAAL;AACA,SAAKC,iBAAL;;AAEA,SAAKC,cAAL;;AAEA,SAAKpB,MAAL,CAAYqB,KAAZ;AACD,GA7BU;AA8BXC,YA9BW,sBA8BAvE,GA9BA,EA8BKwE,OA9BL,EA8Bc;AACvB,QAAIC,UAAU,0DAAd;AACA,QAAIC,gBAAgB,EAApB;;AAEA;AACA,QAAIF,QAAQG,KAAZ,EAAmB;AACjBD,oBAAcE,IAAd,QAAwBJ,QAAQG,KAAhC;AACD;AACD,QAAIH,QAAQK,MAAZ,EAAoB;AAClBH,oBAAcE,IAAd,QAAwBJ,QAAQK,MAAhC;AACD;AACD,QAAIL,QAAQM,OAAZ,EAAqB;AACnBJ,oBAAcE,IAAd,QAAwBJ,QAAQM,OAAhC;AACD;AACD,QAAIN,QAAQO,IAAZ,EAAkB;AAChBL,oBAAcE,IAAd,QAAwBJ,QAAQO,IAAhC;AACD;AACD,QAAIP,QAAQQ,MAAZ,EAAoB;AAClBN,oBAAcE,IAAd,QAAwBJ,QAAQQ,MAAhC;AACD;AACD,QAAIR,QAAQS,QAAZ,EAAsB;AACpBP,oBAAcE,IAAd,iBAAiCJ,QAAQS,QAAzC;AACD;AACD,QAAIT,QAAQU,KAAZ,EAAmB;AACjBR,oBAAcE,IAAd,aAA6BJ,QAAQU,KAArC;AACD;AACD,QAAIV,QAAQW,OAAZ,EAAqB;AACnBT,oBAAcE,IAAd,QAAwBJ,QAAQW,OAAhC;AACD;;AAED;AACAnF,UAAMA,IAAIO,OAAJ,CAAY,OAAZ,EAAqB,SAArB,CAAN;;AAGA,gBAAUkE,OAAV,GAAoBC,cAAcU,IAAd,CAAmB,GAAnB,CAApB,SAA+CpF,GAA/C;AACD,GAjEU;AAkEXqF,eAlEW,yBAkEG5C,IAlEH,EAkES;AAClB;AACA,QAAI6C,gBAAgBC,EAAEC,GAAF,CAAM/C,IAAN,EAAY,gBAAZ,CAApB;AACA,QAAIgD,eAAe,IAAnB;AACA,QAAIH,aAAJ,EAAmB;AACjBG,qBAAkBhD,KAAKiD,SAAL,CAAeC,GAAjC,SAAwClD,KAAKiD,SAAL,CAAeE,KAAvD,SAAgEnD,KAAKiD,SAAL,CAAeG,IAA/E;AACD;;AAED;AACA,QAAIC,YAAYP,EAAEC,GAAF,CAAM/C,IAAN,EAAY,kBAAZ,CAAhB;AACA,QAAIqD,SAAJ,EAAe;AACbA,kBAAY/C,OAAOwB,UAAP,CAAkBuB,SAAlB,EAA6B;AACvCnB,eAAO,GADgC;AAEvCG,iBAAS,EAF8B;AAGvCC,cAAM,OAHiC;AAIvCC,gBAAQ;AAJ+B,OAA7B,CAAZ;AAMD,KAPD,MAOO;AACLc,kBAAY,uBAAZ;AACD;;AAED;AACA,QAAIC,aAAaR,EAAEC,GAAF,CAAM/C,IAAN,EAAY,mBAAZ,CAAjB;AACA,QAAIsD,UAAJ,EAAgB;AACd,UAAIC,oBAAoB;AACtBrB,eAAO,GADe;AAEtBG,iBAAS,EAFa;AAGtBC,cAAM,OAHgB;AAItBC,gBAAQ;AAJc,OAAxB;AAMA,UAAIM,aAAJ,EAAmB;AACjBU,yCACKA,iBADL;AAEEf,oBAAU,EAFZ;AAGEC,iBAAOI;AAHT;AAKD;AACDS,mBAAahD,OAAOwB,UAAP,CAAkBwB,UAAlB,EAA8BC,iBAA9B,CAAb;AACD,KAfD,MAeO;AACLD,mBAAa,8BAAb;AACD;;AAED;AACA,QAAIE,oBAAoBV,EAAEC,GAAF,CAAM/C,IAAN,EAAY,mBAAZ,CAAxB;AACA,QAAIwD,iBAAJ,EAAuB;AACrB,UAAIC,2BAA2B;AAC7BvB,eAAO,GADsB;AAE7BG,iBAAS,EAFoB;AAG7BC,cAAM,OAHuB;AAI7BC,gBAAQ;AAJqB,OAA/B;AAMA,UAAIM,aAAJ,EAAmB;AACjBY,gDACKA,wBADL;AAEEjB,oBAAU,EAFZ;AAGEC,iBAAOI;AAHT;AAKD;AACDW,0BAAoBlD,OAAOwB,UAAP,CAAkB0B,iBAAlB,EAAqCC,wBAArC,CAApB;AACD,KAfD,MAeO;AACLD,0BAAoB,8BAApB;AACD;;AAED;AACA;AACA,QAAIE,aAAa,KAAjB;AACA,QAAIpD,OAAOU,eAAP,KAA2B2C,SAA3B,IAAwCrD,OAAOU,eAAP,GAAyB,CAArE,EAAwE;AACtE0C,mBAAa,IAAb;AACD;AACDpD,WAAOU,eAAP;;AAEA;AACA;AACA,QAAI4C,qBAAqBtD,OAAOuD,qBAAP,CAA6B7D,IAA7B,CAAzB;AACA,QAAI8D,6BAA6B,EAAjC;AACA,QAAIC,gBAAgBjB,EAAEkB,GAAF,CAAMJ,kBAAN,EAA0B,MAA1B,CAApB;AACA,QAAIK,uBAAuBnB,EAAEkB,GAAF,CAAMJ,kBAAN,EAA0B,aAA1B,CAA3B;AACA,QAAI,CAACG,aAAD,IAAkB,CAACE,oBAAvB,EAA6C;AAAA;AAC3C;AACA,YAAIC,aAAapB,EAAEkB,GAAF,CAAMJ,kBAAN,EAA0B,SAA1B,CAAjB;AACA,YAAIO,sBAAsBrB,EAAEkB,GAAF,CAAMJ,kBAAN,EAA0B,kBAA1B,CAA1B;AACA,YAAIM,cAAcC,mBAAlB,EAAuC;AACrCP,6BAAmBQ,OAAnB,GAA6BtB,EAAEuB,MAAF,CAC3BvB,EAAEC,GAAF,CAAMa,kBAAN,EAA0B,SAA1B,EAAqC,EAArC,CAD2B,EAE3Bd,EAAEC,GAAF,CAAMa,kBAAN,EAA0B,kBAA1B,EAA8C,EAA9C,CAF2B,CAA7B;AAIA,iBAAOA,mBAAmBU,gBAA1B;AACD;;AAED,YAAIC,iBAAiB;AACnBH,mBAAS,eADU;AAEnBI,mBAAS,SAFU;AAGnBC,kBAAQ,QAHW;AAInBC,iBAAO;AAJY,SAArB;AAMA5B,UAAE6B,IAAF,CAAOf,kBAAP,EAA2B,UAACgB,KAAD,EAAQC,GAAR,EAAgB;AACzC,cAAI/B,EAAEgC,OAAF,CAAUF,KAAV,CAAJ,EAAsB;AACpBA,oBAAQA,MAAMjC,IAAN,CAAW,IAAX,CAAR;AACD;AACDmB,qCAA2B3B,IAA3B,CAAgC;AAC9B4C,mBAAOR,eAAeM,GAAf,CADuB;AAE9BD;AAF8B,WAAhC;AAID,SARD;AAlB2C;AA2B5C;AACD,QAAII,qCAAqC,CAAClC,EAAEmC,OAAF,CAAUnB,0BAAV,CAA1C;;AAEA,QAAIoB,cAAc;AAChBC,YAAMnF,KAAKoF,QADK;AAEhBC,YAAMrF,KAAKqF,IAFK;AAGhBC,mBAAatF,KAAKsF,WAHF;AAIhBC,uBAAiBjF,OAAOkF,mBAAP,CAA2BxF,IAA3B,EAAiC,MAAjC,CAJD;AAKhByF,8BAAwBnF,OAAOkF,mBAAP,CAA2BxF,IAA3B,EAAiC,aAAjC,CALR;AAMhB0D,4BANgB;AAOhBV,gCAPgB;AAQhBH,kCARgB;AAShBQ,0BATgB;AAUhBC,4BAVgB;AAWhBM,0BAAoBE,0BAXJ;AAYhBkB,4EAZgB;AAahB;AACAxB,0CAdgB;AAehBkC,YAAM1F,KAAK0F,IAfK;AAgBhBhB,aAAO1E,KAAK0E,KAhBI;AAiBhBD,cAAQzE,KAAKyE,MAjBG;AAkBhBkB,eAAS3F,KAAK2F,OAlBE;AAmBhBnB,eAASxE,KAAKwE;AAnBE,KAAlB;;AAsBA,wBACKU,WADL;AAEEU,YAAMC,KAAKC,SAAL,CAAeZ,WAAf;AAFR;AAID,GAvMU;AAwMXa,sBAxMW,gCAwMU/F,IAxMV,EAwMgB;AACzB;AACA,QAAIgG,aAAa,CAAC,OAAD,EAAU,QAAV,EAAoB,SAApB,EAA+B,SAA/B,CAAjB;;AAEA;AACA,QAAIC,cAAc,EAAlB;AACAnD,MAAE6B,IAAF,CAAOqB,UAAP,EAAmB,UAACE,SAAD,EAAe;AAChC,UAAIC,mBAAmB7F,OAAOE,MAAP,CAAcO,MAAd,CAAqBqF,cAArB,CAAoCF,SAApC,CAAvB;AACAD,kBAAYC,SAAZ,IAAyBpD,EAAEuD,GAAF,CAAMF,gBAAN,EAAwB,UAACG,UAAD,EAAgB;AAC/D,eAAOA,WAAW1B,KAAlB;AACD,OAFwB,CAAzB;AAGD,KALD;;AAOA;AACA,QAAI2B,SAAS,EAAb;AACAzD,MAAE6B,IAAF,CAAOqB,UAAP,EAAmB,UAACE,SAAD,EAAe;AAChCK,aAAOL,SAAP,IAAoBpD,EAAEuD,GAAF,CAAMrG,KAAKkG,SAAL,CAAN,EAAuB,UAACM,UAAD,EAAgB;AACzD,eAAO;AACL5B,iBAAO4B,UADF;AAELC,qBAAW3D,EAAE4D,QAAF,CAAWT,YAAYC,SAAZ,CAAX,EAAmCM,UAAnC;AAFN,SAAP;AAID,OALmB,CAApB;AAMD,KAPD;;AASA;AACA,QAAIG,YAAY7D,EAAE8D,SAAF,CAAYL,MAAZ,EAAoB,UAAC3B,KAAD,EAAQC,GAAR,EAAgB;AAClD,aAAOA,IAAIgC,MAAJ,GAAa,CAApB;AACD,KAFe,CAAhB;;AAIA,QAAIC,cAAc;AAChB3B,YAAMnF,KAAKmF,IADK;AAEhBE,YAAMrF,KAAKqF,IAFK;AAGhBC,mBAAatF,KAAKsF,WAHF;AAIhBiB,oBAJgB;AAKhBI,0BALgB;AAMhBjB,YAAM1F,KAAK0F,IANK;AAOhB7C,qBAAe7C,KAAK6C,aAPJ;AAQhBQ,iBAAWrD,KAAKqD,SARA;AAShBC,kBAAYtD,KAAKwD;AATD,KAAlB;;AAYAuD,YAAQC,IAAR,CAAaF,WAAb;;AAEA,WAAOA,WAAP;AACD,GApPU;AAqPXjD,uBArPW,iCAqPW7D,IArPX,EAqPiB;AAC1B,QAAIiH,qBAAqBjH,KAAKkH,gBAA9B;AACA,QAAI,CAACD,kBAAL,EAAyB;AACvB,aAAO,EAAP;AACD;AACD,QAAIrD,qBAAqB,EAAzB;AACAd,MAAE6B,IAAF,CAAOsC,kBAAP,EAA2B,UAACE,cAAD,EAAiBC,aAAjB,EAAmC;AAC5D;AACA,UAAItE,EAAEuE,QAAF,CAAWF,cAAX,KAA8BA,eAAeG,UAAf,KAA8B,MAAhE,EAAwE;AACtE1D,2BAAmBwD,aAAnB,IAAoCD,eAAevC,KAAnD;AACA;AACD;AACD;AACA,UAAI9B,EAAEgC,OAAF,CAAUqC,cAAV,CAAJ,EAA+B;AAC7BvD,2BAAmBwD,aAAnB,IAAoCtE,EAAEyE,OAAF,CAAUzE,EAAEuD,GAAF,CAAMc,cAAN,EAAsB,UAACK,UAAD,EAAgB;AAClF,cAAIA,WAAWF,UAAX,KAA0B,MAA9B,EAAsC;AACpC,mBAAO,IAAP;AACD;AACD,iBAAOE,WAAW5C,KAAlB;AACD,SAL6C,CAAV,CAApC;AAMD;AACF,KAfD;;AAiBA,WAAO9B,EAAE2E,MAAF,CAAS7D,kBAAT,EAA6Bd,EAAEmC,OAA/B,CAAP;AACD,GA7QU;AA8QXO,qBA9QW,+BA8QSkC,MA9QT,EA8QiBC,QA9QjB,EA8Q2B;AACpC,QAAI,CAAC7E,EAAEkB,GAAF,CAAM0D,MAAN,wBAAkCC,QAAlC,YAAL,EAA0D;AACxD,aAAOD,OAAOC,QAAP,CAAP;AACD;AACD,WAAOD,OAAOR,gBAAP,CAAwBS,QAAxB,EAAkC/C,KAAzC;AACD,GAnRU;;AAoRX;AACA1D,UArRW,sBAqRA;AACT,QAAI0G,OAAOC,EAAE,MAAF,CAAX;AACA,aAASC,SAAT,CAAmBC,GAAnB,EAAwB;AACtBF,QAAEE,GAAF,EAAOC,QAAP,CAAgB,iBAAhB;AACD;AACDlF,MAAE6B,IAAF,CAAOiD,IAAP,EAAa,UAACG,GAAD,EAAS;AACpBrE,iBAAWqE,GAAX,EAAgB,EAACE,QAAQ,EAAT,EAAhB,EAA8BH,SAA9B;AACD,KAFD;AAGD,GA7RU;AA8RX3G,oBA9RW,gCA8RU;AACnB,SAAKX,MAAL,CAAY0H,SAAZ,CACEzH,cAAc0H,OAAd,CAAsBC,SAAtB,CAAgC;AAC9BC,iBAAW,IADmB;AAE9BC,mBAAa;AAFiB,KAAhC,CADF;AAMD,GArSU;AAsSXlH,gBAtSW,4BAsSM;AACf,SAAKZ,MAAL,CAAY0H,SAAZ,CACEzH,cAAc0H,OAAd,CAAsBI,KAAtB,CAA4B;AAC1BF,iBAAW;AADe,KAA5B,CADF;AAKD,GA5SU;AA6SXhH,gBA7SW,4BA6SM;AACf,SAAKb,MAAL,CAAY0H,SAAZ,CACEzH,cAAc0H,OAAd,CAAsBK,cAAtB,CAAqC;AACnCH,iBAAW,QADwB;AAEnCjB,qBAAe,OAFoB;AAGnCqB,gBAAU,KAHyB;AAInCC,aAAO,EAJ4B;AAKnCC,cAAQ,CAAC,WAAD,EAAc,YAAd,EAA4B,UAA5B,CAL2B;AAMnCC,gBAAU;AACRF,eAAO;AADC;AANyB,KAArC,CADF;AAYD,GA1TU;AA2TXnH,iBA3TW,6BA2TO;AAChB,SAAKf,MAAL,CAAY0H,SAAZ,CACEzH,cAAc0H,OAAd,CAAsBK,cAAtB,CAAqC;AACnCH,iBAAW,SADwB;AAEnCjB,qBAAe,QAFoB;AAGnCqB,gBAAU,KAHyB;AAInCC,aAAO,EAJ4B;AAKnCC,cAAQ,CAAC,WAAD,EAAc,YAAd,EAA4B,UAA5B,CAL2B;AAMnCC,gBAAU;AACRF,eAAO;AADC;AANyB,KAArC,CADF;AAYD,GAxUU;AAyUXpH,kBAzUW,8BAyUQ;AACjB,SAAKd,MAAL,CAAY0H,SAAZ,CACEzH,cAAc0H,OAAd,CAAsBK,cAAtB,CAAqC;AACnCH,iBAAW,UADwB;AAEnCjB,qBAAe,SAFoB;AAGnCqB,gBAAU,KAHyB;AAInCC,aAAO,EAJ4B;AAKnCC,cAAQ,CAAC,WAAD,EAAc,YAAd,EAA4B,UAA5B,CAL2B;AAMnCC,gBAAU;AACRF,eAAO;AADC;AANyB,KAArC,CADF;AAYD,GAtVU;AAuVXlH,kBAvVW,8BAuVQ;AACjB,SAAKhB,MAAL,CAAY0H,SAAZ,CACEzH,cAAc0H,OAAd,CAAsBK,cAAtB,CAAqC;AACnCH,iBAAW,UADwB;AAEnCjB,qBAAe,SAFoB;AAGnCqB,gBAAU,IAHyB;AAInCC,aAAO,EAJ4B;AAKnCC,cAAQ,CAAC,WAAD,EAAc,YAAd,EAA4B,UAA5B;AAL2B,KAArC,CADF;AASD,GAjWU;AAkWXlH,eAlWW,2BAkWK;AACd,QAAIoH,cAAchB,EAAE,cAAF,EAAkBiB,IAAlB,EAAlB;AACA,QAAIC,gBAAgBlB,EAAE,oBAAF,EAAwBiB,IAAxB,EAApB;AACA,SAAKtI,MAAL,CAAY0H,SAAZ,CACEzH,cAAc0H,OAAd,CAAsBP,IAAtB,CAA2B;AACzBS,iBAAW,OADc;AAEzBW,mBAAa,EAFY;AAGzBC,iBAAW;AACTC,eAAOH,aADE;AAETI,cAAMN;AAFG,OAHc;AAOzBO,qBAAe;AACbD,cAAM7I,OAAOsC;AADA;AAPU,KAA3B,CADF;AAaD,GAlXU;AAmXXlB,qBAnXW,iCAmXW;AACpB,SAAKlB,MAAL,CAAY0H,SAAZ,CACEzH,cAAc0H,OAAd,CAAsBkB,UAAtB,CAAiC;AAC/BhB,iBAAW,aADoB;AAE/BiB,cAAQ;AACNC,kBAAU,YADJ;AAENC,cAAM;AAFA,OAFuB;AAM/BC,qBAAe;AANgB,KAAjC,CADF;AAUD,GA9XU;AA+XX9H,mBA/XW,+BA+XS;AAClB,SAAKnB,MAAL,CAAY0H,SAAZ,CACEzH,cAAc0H,OAAd,CAAsBuB,oBAAtB,CAA2C;AACzCrB,iBAAW,yBAD8B;AAEzCsB,gBAAU;AAF+B,KAA3C,CADF;AAMD,GAtYU;AAuYX/H,gBAvYW,4BAuYM;AAAA;;AACf,QAAIyG,YAAYR,EAAE,eAAF,CAAhB;AACA,QAAI+B,WAAWC,MAAMC,OAAN,CAAcjC,EAAE,kBAAF,EAAsBiB,IAAtB,EAAd,CAAf;AACA,QAAIiB,UAAUlC,EAAE,aAAF,CAAd;AACA,aAASmC,YAAT,GAAwB;AACtB3B,gBAAU4B,WAAV,CAAsB,0BAAtB;AACD;;AAED;AACA;AACApC,MAAE,OAAF,EAAW5G,EAAX,CAAc,OAAd,EAAuB,MAAvB,EAA+B,UAACnB,KAAD,EAAW;AACxCuI,gBAAUL,QAAV,CAAmB,0BAAnB;AACA,UAAID,MAAMjI,MAAMoK,aAAhB;AACA,UAAItE,OAAOiC,EAAEE,GAAF,EAAOoC,IAAP,CAAY,sBAAZ,EAAoCC,IAApC,EAAX;AACA,UAAIpK,OAAOM,OAAOyF,oBAAP,CAA4BF,KAAKwE,KAAL,CAAWzE,IAAX,CAA5B,CAAX;AACAmE,cAAQjB,IAAR,CAAac,SAASU,MAAT,CAAgBtK,IAAhB,CAAb;AACD,KAND;;AAQA;AACA+J,YAAQ9I,EAAR,CAAW,OAAX,EAAoB,oBAApB,EAA0C+I,YAA1C;;AAEA;AACAD,YAAQ9I,EAAR,CAAW,OAAX,EAAoB,oBAApB,EAA0C,UAACsJ,MAAD,EAAY;AACpD,UAAIC,SAAS3C,EAAE0C,OAAOL,aAAT,CAAb;AACA,UAAIhE,YAAYsE,OAAOxK,IAAP,CAAY,YAAZ,CAAhB;AACA,UAAIwG,aAAagE,OAAOJ,IAAP,EAAjB;AACA,YAAK5J,MAAL,CAAYO,MAAZ,CAAmB0J,gBAAnB,CAAoCvE,SAApC,EAA+CM,UAA/C,EAA2DhG,MAA3D;AACAgK,aAAOE,WAAP,CAAmB,2BAAnB;AACD,KAND;AAOD;AApaU,CAAb;;kBAuaepK,M","file":"public/app.js","sourcesContent":["/* jshint ignore:start */\n(function() {\n  var WebSocket = window.WebSocket || window.MozWebSocket;\n  var br = window.brunch = (window.brunch || {});\n  var ar = br['auto-reload'] = (br['auto-reload'] || {});\n  if (!WebSocket || ar.disabled) return;\n\n  var cacheBuster = function(url){\n    var date = Math.round(Date.now() / 1000).toString();\n    url = url.replace(/(\\&|\\\\?)cacheBuster=\\d*/, '');\n    return url + (url.indexOf('?') >= 0 ? '&' : '?') +'cacheBuster=' + date;\n  };\n\n  var browser = navigator.userAgent.toLowerCase();\n  var forceRepaint = ar.forceRepaint || browser.indexOf('chrome') > -1;\n\n  var reloaders = {\n    page: function(){\n      window.location.reload(true);\n    },\n\n    stylesheet: function(){\n      [].slice\n        .call(document.querySelectorAll('link[rel=stylesheet]'))\n        .filter(function(link) {\n          var val = link.getAttribute('data-autoreload');\n          return link.href && val != 'false';\n        })\n        .forEach(function(link) {\n          link.href = cacheBuster(link.href);\n        });\n\n      // Hack to force page repaint after 25ms.\n      if (forceRepaint) setTimeout(function() { document.body.offsetHeight; }, 25);\n    }\n  };\n  var port = ar.port || 9485;\n  var host = br.server || window.location.hostname || 'localhost';\n\n  var connect = function(){\n    var connection = new WebSocket('ws://' + host + ':' + port);\n    connection.onmessage = function(event){\n      if (ar.disabled) return;\n      var message = event.data;\n      var reloader = reloaders[message] || reloaders.page;\n      reloader();\n    };\n    connection.onerror = function(){\n      if (connection.readyState) connection.close();\n    };\n    connection.onclose = function(){\n      window.setTimeout(connect, 1000);\n    };\n  };\n  connect();\n})();\n/* jshint ignore:end */","let Marvel = {\n  init() {\n    this.search = instantsearch({\n      appId: 'O3F8QXYK6R',\n      apiKey: '78e45b023b7ff7d8ba88c59c9db19890',\n      indexName: 'marvel',\n      urlSync: true,\n      searchFunction: (helper) => {\n        // Reset the lazyloadCounter\n        Marvel.lazyloadCounter = 0;\n        helper.search();\n      }\n    });\n\n    this.search.on('render', this.onRender);\n\n    this.addSearchBoxWidget();\n    this.addStatsWidget();\n    this.addTeamsWidget();\n    this.addAuthorsWidget();\n    this.addPowersWidget();\n    this.addSpeciesWidget();\n    this.addHitsWidget();\n    this.addPaginationWidget();\n    this.addRefinementList();\n\n    this.addOpenProfile();\n\n    this.search.start();\n  },\n  cloudinary(url, options) {\n    let baseUrl = 'http://res.cloudinary.com/pixelastic-marvel/image/fetch/';\n    let stringOptions = [];\n\n    // Handle common Cloudinary options\n    if (options.width) {\n      stringOptions.push(`w_${options.width}`);\n    }\n    if (options.height) {\n      stringOptions.push(`h_${options.height}`);\n    }\n    if (options.quality) {\n      stringOptions.push(`q_${options.quality}`);\n    }\n    if (options.crop) {\n      stringOptions.push(`c_${options.crop}`);\n    }\n    if (options.format) {\n      stringOptions.push(`f_${options.format}`);\n    }\n    if (options.colorize) {\n      stringOptions.push(`e_colorize:${options.colorize}`);\n    }\n    if (options.color) {\n      stringOptions.push(`co_rgb:${options.color}`);\n    }\n    if (options.gravity) {\n      stringOptions.push(`g_${options.gravity}`);\n    }\n\n    // Fix remote urls\n    url = url.replace(/^\\/\\//, 'http://');\n\n\n    return `${baseUrl}${stringOptions.join(',')}/${url}`;\n  },\n  transformItem(data) {\n    // Main color\n    let mainColorHexa = _.get(data, 'mainColor.hexa');\n    let mainColorRgb = null;\n    if (mainColorHexa) {\n      mainColorRgb = `${data.mainColor.red},${data.mainColor.green},${data.mainColor.blue}`;\n    }\n\n    // Thumbnail\n    let thumbnail = _.get(data, 'images.thumbnail');\n    if (thumbnail) {\n      thumbnail = Marvel.cloudinary(thumbnail, {\n        width: 200,\n        quality: 90,\n        crop: 'scale',\n        format: 'auto'\n      });\n    } else {\n      thumbnail = './img/hit-default.jpg';\n    }\n\n    // Background image\n    let background = _.get(data, 'images.background');\n    if (background) {\n      let backgroundOptions = {\n        width: 450,\n        quality: 90,\n        crop: 'scale',\n        format: 'auto'\n      };\n      if (mainColorHexa) {\n        backgroundOptions = {\n          ...backgroundOptions,\n          colorize: 40,\n          color: mainColorHexa\n        };\n      }\n      background = Marvel.cloudinary(background, backgroundOptions);\n    } else {\n      background = './img/profile-bg-default.gif';\n    }\n\n    // Background image for profile\n    let backgroundProfile = _.get(data, 'images.background');\n    if (backgroundProfile) {\n      let backgroundProfileOptions = {\n        width: 600,\n        quality: 90,\n        crop: 'scale',\n        format: 'auto'\n      };\n      if (mainColorHexa) {\n        backgroundProfileOptions = {\n          ...backgroundProfileOptions,\n          colorize: 40,\n          color: mainColorHexa\n        };\n      }\n      backgroundProfile = Marvel.cloudinary(backgroundProfile, backgroundProfileOptions);\n    } else {\n      backgroundProfile = './img/profile-bg-default.gif';\n    }\n\n    // All items are defered loading their images until in viewport, except\n    // the 4 first\n    let inViewport = false;\n    if (Marvel.lazyloadCounter === undefined || Marvel.lazyloadCounter < 4) {\n      inViewport = true;\n    }\n    Marvel.lazyloadCounter++;\n\n    // If the match is not obvious (not in the name of description), we display\n    // where it is found\n    let matchingAttributes = Marvel.getMatchingAttributes(data);\n    let readableMatchingAttributes = [];\n    let isFoundInName = _.has(matchingAttributes, 'name');\n    let isFoundInDescription = _.has(matchingAttributes, 'description');\n    if (!isFoundInName && !isFoundInDescription) {\n      // Merging aliases and secret identities\n      let hasAliases = _.has(matchingAttributes, 'aliases');\n      let hasSecretIdentities = _.has(matchingAttributes, 'secretIdentities');\n      if (hasAliases || hasSecretIdentities) {\n        matchingAttributes.aliases = _.concat(\n          _.get(matchingAttributes, 'aliases', []),\n          _.get(matchingAttributes, 'secretIdentities', [])\n        );\n        delete matchingAttributes.secretIdentities;\n      }\n\n      let readableTitles = {\n        aliases: 'Also known as',\n        authors: 'Authors',\n        powers: 'Powers',\n        teams: 'Teams'\n      };\n      _.each(matchingAttributes, (value, key) => {\n        if (_.isArray(value)) {\n          value = value.join(', ');\n        }\n        readableMatchingAttributes.push({\n          label: readableTitles[key],\n          value\n        });\n      });\n    }\n    let isMatchingInNotDisplayedAttributes = !_.isEmpty(readableMatchingAttributes);\n\n    let displayData = {\n      uuid: data.objectID,\n      name: data.name,\n      description: data.description,\n      highlightedName: Marvel.getHighlightedValue(data, 'name'),\n      highlightedDescription: Marvel.getHighlightedValue(data, 'description'),\n      inViewport,\n      mainColorRgb,\n      mainColorHexa,\n      thumbnail,\n      background,\n      matchingAttributes: readableMatchingAttributes,\n      isMatchingInNotDisplayedAttributes,\n      // Used by the profile only\n      backgroundProfile,\n      urls: data.urls,\n      teams: data.teams,\n      powers: data.powers,\n      species: data.species,\n      authors: data.authors\n    };\n\n    return {\n      ...displayData,\n      json: JSON.stringify(displayData)\n    };\n  },\n  transformProfileData(data) {\n    // Enhance facets (isRefined, hasType)\n    let facetNames = ['teams', 'powers', 'species', 'authors'];\n\n    // Keep record of current filters\n    let refinements = {};\n    _.each(facetNames, (facetName) => {\n      let facetRefinements = Marvel.search.helper.getRefinements(facetName);\n      refinements[facetName] = _.map(facetRefinements, (refinement) => {\n        return refinement.value;\n      });\n    });\n\n    // Create an array of objects for each facet name\n    let facets = {};\n    _.each(facetNames, (facetName) => {\n      facets[facetName] = _.map(data[facetName], (facetValue) => {\n        return {\n          value: facetValue,\n          isRefined: _.includes(refinements[facetName], facetValue)\n        };\n      });\n    });\n\n    // Get an object to tell us if the character has values for this facets\n    let hasFacets = _.mapValues(facets, (value, key) => {\n      return key.length > 0;\n    });\n\n    let profileData = {\n      uuid: data.uuid,\n      name: data.name,\n      description: data.description,\n      facets,\n      hasFacets,\n      urls: data.urls,\n      mainColorHexa: data.mainColorHexa,\n      thumbnail: data.thumbnail,\n      background: data.backgroundProfile\n    };\n\n    console.info(profileData);\n\n    return profileData;\n  },\n  getMatchingAttributes(data) {\n    let highlightedResults = data._highlightResult;\n    if (!highlightedResults) {\n      return {};\n    }\n    let matchingAttributes = {};\n    _.each(highlightedResults, (highlightValue, attributeName) => {\n      // Matching in a string attribute\n      if (_.isObject(highlightValue) && highlightValue.matchLevel === 'full') {\n        matchingAttributes[attributeName] = highlightValue.value;\n        return;\n      }\n      // Matching in an array\n      if (_.isArray(highlightValue)) {\n        matchingAttributes[attributeName] = _.compact(_.map(highlightValue, (matchValue) => {\n          if (matchValue.matchLevel === 'none') {\n            return null;\n          }\n          return matchValue.value;\n        }));\n      }\n    });\n\n    return _.omitBy(matchingAttributes, _.isEmpty);\n  },\n  getHighlightedValue(object, property) {\n    if (!_.has(object, `_highlightResult.${property}.value`)) {\n      return object[property];\n    }\n    return object._highlightResult[property].value;\n  },\n  // Enable lazyloading of images below the fold\n  onRender() {\n    let hits = $('.hit');\n    function onVisible(hit) {\n      $(hit).addClass('hit__inViewport');\n    }\n    _.each(hits, (hit) => {\n      inViewport(hit, {offset: 50}, onVisible);\n    });\n  },\n  addSearchBoxWidget() {\n    this.search.addWidget(\n      instantsearch.widgets.searchBox({\n        container: '#q',\n        placeholder: 'Search for any character, power, secret identity'\n      })\n    );\n  },\n  addStatsWidget() {\n    this.search.addWidget(\n      instantsearch.widgets.stats({\n        container: '#stats'\n      })\n    );\n  },\n  addTeamsWidget() {\n    this.search.addWidget(\n      instantsearch.widgets.refinementList({\n        container: '#teams',\n        attributeName: 'teams',\n        operator: 'and',\n        limit: 10,\n        sortBy: ['isRefined', 'count:desc', 'name:asc'],\n        showMore: {\n          limit: 20\n        }\n      })\n    );\n  },\n  addPowersWidget() {\n    this.search.addWidget(\n      instantsearch.widgets.refinementList({\n        container: '#powers',\n        attributeName: 'powers',\n        operator: 'and',\n        limit: 10,\n        sortBy: ['isRefined', 'count:desc', 'name:asc'],\n        showMore: {\n          limit: 20\n        }\n      })\n    );\n  },\n  addAuthorsWidget() {\n    this.search.addWidget(\n      instantsearch.widgets.refinementList({\n        container: '#authors',\n        attributeName: 'authors',\n        operator: 'and',\n        limit: 10,\n        sortBy: ['isRefined', 'count:desc', 'name:asc'],\n        showMore: {\n          limit: 20\n        }\n      })\n    );\n  },\n  addSpeciesWidget() {\n    this.search.addWidget(\n      instantsearch.widgets.refinementList({\n        container: '#species',\n        attributeName: 'species',\n        operator: 'or',\n        limit: 10,\n        sortBy: ['isRefined', 'count:desc', 'name:asc']\n      })\n    );\n  },\n  addHitsWidget() {\n    let hitTemplate = $('#hitTemplate').html();\n    let emptyTemplate = $('#noResultsTemplate').html();\n    this.search.addWidget(\n      instantsearch.widgets.hits({\n        container: '#hits',\n        hitsPerPage: 10,\n        templates: {\n          empty: emptyTemplate,\n          item: hitTemplate\n        },\n        transformData: {\n          item: Marvel.transformItem\n        }\n      })\n    );\n  },\n  addPaginationWidget() {\n    this.search.addWidget(\n      instantsearch.widgets.pagination({\n        container: '#pagination',\n        labels: {\n          previous: '‹ Previous',\n          next: 'Next ›'\n        },\n        showFirstLast: false\n      })\n    );\n  },\n  addRefinementList() {\n    this.search.addWidget(\n      instantsearch.widgets.currentRefinedValues({\n        container: '#current-refined-values',\n        clearAll: 'before'\n      })\n    );\n  },\n  addOpenProfile() {\n    let container = $('.js-container');\n    let template = Hogan.compile($('#profileTemplate').html());\n    let profile = $('.js-profile');\n    function closeProfile() {\n      container.removeClass('l-container__withProfile');\n    }\n\n    // Clicking a result will open the profile, render the template and put it\n    // in the profile\n    $('.hits').on('click', '.hit', (event) => {\n      container.addClass('l-container__withProfile');\n      let hit = event.currentTarget;\n      let json = $(hit).find('.js-hit--json-holder').text();\n      let data = Marvel.transformProfileData(JSON.parse(json));\n      profile.html(template.render(data));\n    });\n\n    // Let users close it\n    profile.on('click', '.js-profile--close', closeProfile);\n\n    // Let user add/remove refinements when clicking on it\n    profile.on('click', '.js-profile--facet', (_event) => {\n      let target = $(_event.currentTarget);\n      let facetName = target.data('facet-name');\n      let facetValue = target.text();\n      this.search.helper.toggleRefinement(facetName, facetValue).search();\n      target.toggleClass('profile--facet__isRefined');\n    });\n  }\n};\n\nexport default Marvel;\n"]}